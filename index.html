<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:title" content="Detective Marty">
    <meta property="og:description" content="on the case!">
    <meta property="og:image" content="https://emyleaf.github.io/detectivemarty/img/faviconstuff/icon.jpeg">
    <meta property="og:url" content="https://emyleaf.github.io/detectivemarty">
    <meta name="twitter:card" content="summary_large_image">
    <meta property="og:type" content="website">
    <meta name="twitter:image" content="https://emyleaf.github.io/detectivemarty/img/faviconstuff/icon.jpeg">

    <link rel="icon" type="image/png" href="./img/faviconstuff/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="./img/faviconstuff/favicon.svg" />
    <link rel="shortcut icon" href="./img/faviconstuff/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="./img/faviconstuff/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="Detective Marty" />
    <link rel="manifest" href="./img/faviconstuff/site.webmanifest" />

    <link rel="stylesheet" href="./css/style.css">
    <link href="https://fonts.googleapis.com/css?family=Press+Start+2P" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IM+Fell+DW+Pica:ital@0;1&display=swap" rel="stylesheet">

    <style>
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease-out;
        }

        #loading-screen.fade-out {
            opacity: 0;
            pointer-events: none;
        }

        .loader-logo {
            width: 200px;
            height: auto;
            margin-bottom: 2rem;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }

        .loading-bar-container {
            width: 300px;
            height: 8px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .loading-bar {
            height: 100%;
            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 10px;
        }

        .loading-text {
            color: #fff;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8rem;
            margin-top: 1rem;
        }

        .loading-percentage {
            color: #4facfe;
            font-family: 'Press Start 2P', cursive;
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }

        #main-content {
            display: none;
        }

        #main-content.show {
            display: block;
        }
    </style>

    <title>Detective Marty</title>
</head>
<body>

    <!-- Loading Screen -->
    <div id="loading-screen">
        <img src="./img/marty.png" alt="Detective Marty" class="loader-logo">
        <div class="loading-percentage" id="loading-percentage">0%</div>
        <div class="loading-bar-container">
            <div class="loading-bar" id="loading-bar"></div>
        </div>
        <div class="loading-text">Caricamento...</div>
    </div>

    <div id="main-content">
        <div class="background_image"></div>

    <section  class="section centro transition-fade">
        
        <div class="has-text-centered">
            <figure class="image mamalogo centro logo">
                <a href="index.html"><img src="./img/logo.png" alt="Placeholder image"></a>
            </figure>
        </div>

        <div class="content-wrapper">
            <div class="buttons-section">
                <a id="casi-button"><img class="buttonmenu" src="./img/casi.png" alt="" style="width: 12em; height: auto; margin-top: 5em;"></a>
                <a href="./work.html" id="dossier-button"><img class="buttonmenu" src="./img/dossier.png" alt="" style="width: 12em; height: auto;"></a>
                <a href="./caso1.html" id="caso1-button" class="hidden"><img src="./img/caso1.png" alt="" style="width: 12em; height: auto; margin-top: 4em;"></a>
            </div>
            
            <div class="character-section">
                <figure class="image centro marti logo" style="width: 15em;">
                    <img id="hellomama-image" src="./img/marty.png" alt="mama1">
                    <img id="hellomama-image2" style="display: none;" src="./img/hellomama3.png" alt="mama2">
                </figure>
            </div>
        </div>

    </section>
    </div>

    <script>
        // Preload all resources
        const resourcesToLoad = [
            // Images
            './img/logo.png',
            './img/logo_primocaso.png',
            './img/marty.png',
            './img/hellomama3.png',
            './img/casi.png',
            './img/dossier.png',
            './img/caso1.png',
            './img/anna.png',
            './img/elena.png',
            './img/giotto.png',
            './img/james.png',
            './img/lucas.png',
            './img/marco.png',
            './img/marie.png',
            './img/sofia.png',
            './img/portamoduli.png',
            './img/gallo.png',
            './img/sospettati.png',
            './img/ask.png',
            './img/call.png',
            './img/letter.png',
            './img/torta.png',
            './img/gnam.png',
            './img/gnam2.png',
            './img/work.png',
            './img/sfondo1.png',
            './img/screambaloon.png',
            './img/dialogue gallo.png',
            './img/foto1.png',
            './img/primaprova.png',
            './img/prova2.png',
            './img/prova3.png',
            './img/prova4.png',
            './img/reference.png',
            // Audio files
            './audio/anna.mp3',
            './audio/elena.mp3',
            './audio/giotto.mp3',
            './audio/james.mp3',
            './audio/lucas.mp3',
            './audio/marco.mp3',
            './audio/marie.mp3',
            './audio/sofia.mp3',
            './audio/phone_call.mp3',
            './audio/misscall.mp3',
            './audio/dexter.mp3',
            './audio/prova.mp3'
        ];

        let loadedCount = 0;
        const totalResources = resourcesToLoad.length;
        const loadingBar = document.getElementById('loading-bar');
        const loadingPercentage = document.getElementById('loading-percentage');

        function updateProgress() {
            loadedCount++;
            const percentage = Math.round((loadedCount / totalResources) * 100);
            loadingBar.style.width = percentage + '%';
            loadingPercentage.textContent = percentage + '%';

            if (loadedCount === totalResources) {
                setTimeout(() => {
                    const loadingScreen = document.getElementById('loading-screen');
                    const mainContent = document.getElementById('main-content');
                    
                    loadingScreen.classList.add('fade-out');
                    mainContent.classList.add('show');
                    
                    setTimeout(() => {
                        loadingScreen.style.display = 'none';
                    }, 500);
                }, 300);
            }
        }

        function preloadResource(url) {
            return new Promise((resolve, reject) => {
                if (url.endsWith('.mp3')) {
                    const audio = new Audio();
                    audio.addEventListener('canplaythrough', () => {
                        updateProgress();
                        resolve();
                    }, { once: true });
                    audio.addEventListener('error', () => {
                        console.warn('Failed to load audio:', url);
                        updateProgress();
                        resolve();
                    });
                    audio.src = url;
                } else {
                    const img = new Image();
                    img.onload = () => {
                        updateProgress();
                        resolve();
                    };
                    img.onerror = () => {
                        console.warn('Failed to load image:', url);
                        updateProgress();
                        resolve();
                    };
                    img.src = url;
                }
            });
        }

        // Start preloading
        Promise.all(resourcesToLoad.map(url => preloadResource(url)))
            .then(() => {
                console.log('All resources loaded!');
            })
            .catch(err => {
                console.error('Error loading resources:', err);
            });
    </script>
    <script src="./js/index.js"></script>

</body>
</html>